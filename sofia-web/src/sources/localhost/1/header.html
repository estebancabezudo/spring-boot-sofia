<link lib="burgerMenu:1.00" />
<link lib="linkTo:1.00" />
<link lib="twoLanguageFlag:1.00" />
<style>
    :root {
        --headerHeight: #{header.height};
        --primaryColor: #116223;
    }

    #headerContainer {
        display: flex;
        position: fixed;
        box-sizing: border-box;
        width: 100%;
        height: var(--headerHeight);
        background-color: var(--primaryColor);
        justify-content: space-between;
        align-items: center;
    }

    #headerLogoContainer {
        display: flex;
        position: fixed;
        align-items: flex-end;
        width: 100%;
        justify-content: space-between;
    }

    #headerLogo {
        width: 100px;
        height: auto;
        aspect-ratio: 399/124;
        background-image: url(/images/logoSofia.png);
        background-size: contain;
        background-repeat: no-repeat;
        margin-left: 20px;
        margin-top: 6px;
    }

    .logoBackground {
        background-color: var(--primaryColor);
        width: 100%;
        height: var(--headerHeight);
        position: fixed;
        right: 0;
        top: 0;
    }

    #headerMenuContainer {
        font-weight: bold;
        color: white;
        width: 100%;
        background-color: var(--primaryColor);
        right: 0;
    }

    .burguerMenuContainer {
        top: -59px;
        align-items: center;
        justify-content: space-between;
        transition: top .2s ease-out;
    }

    .burguerMenuContainerActive {
        display: flex;
        top: var(--headerHeight);
    }

    .menuItems {
        padding: 0 20px;
        display: flex;
        flex-direction: row;
        align-items: center;
    }

    .menuItem>span {
        cursor: pointer;
        margin: 0 10px;
    }

    .headerIcon {
        width: 28px;
        height: 28px;
        background-repeat: no-repeat;
        background-position: center;
        cursor: pointer;
    }

    .headerBurgerMenuActivator {
        background-image: url(/images/burgerMenu/1.00/burger.svg);
        margin-right: 20px;
    }

    .headerMenuClose {
        background-image: url(/images/burgerMenu/1.00/close.svg);
    }

    .messages {
        display: flex;
        width: 100%;
        padding: 5px;
        color: white;
        flex-wrap: nowrap;
        overflow: hidden;
        font-weight: bold;
        pointer-events: none;
        transition: background-color .2s ease-out;
    }

    .errorMessage {
        background-color: rgb(177, 40, 40);
    }

    @media all and (min-width: 750px) {

        .burguerMenuContainer {
            position: relative;
            display: flex;
            top: 0;
            justify-content: flex-end;
            transition: none;
        }

        .logoBackground {
            display: none;
        }

        #headerBurgerMenuActivator {
            display: none;
        }

        #headerLogoContainer {
            width: auto;
        }
    }
</style>

<script>
    const initHeader = () => {
        const burgerMenu = new BurgerMenu(
            {
                menuContainerId: 'headerMenuContainer',
                openMenuElementId: 'headerBurgerMenuActivator',
                closeMenuElementId: 'headerBurgerMenuActivator',
                items: [
                    {
                        id: 'users',
                        hide: ['page:/admin/users/list.html'],
                        onclick: '/admin/users/list.html'
                    },
                    {
                        id: 'places',
                        hide: ['page:/admin/places/list.html'],
                        onclick: '/admin/places/list.html'
                    },
                    {
                        id: 'login',
                        hide: ['status:logged', 'page:/login.html'],
                        show: ['status:notLogged'],
                        onclick: '/login.html'
                    },
                    {
                        id: 'logout',
                        hide: ['status:notLogged'],
                        show: ['status:logged'],
                        onclick: '/logout'
                    }
                ]
            }
        );
        new LinkTo({
            id: 'headerLogo',
            onclick: '/',
            disableWhen: ['page:/'],
        });
        new TwoLanguageFlag({
            id: 'twoLanguageFlag',
            languages: [{ code: 'en' }, { code: 'es' }],
            onchange: language => {
                fetch('/v1/web/clients/actual/languages/default', {
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    method: 'PUT',
                    body: `{ "code": "${language}"}`
                });
            }
        });
        Core.subscribeTo('core:showErrorMessage', data => {
            console.log(`header.html::initHeader::showErrorMessage::data: `, data);
            const hideMessage = () => {
                element.classList.remove('errorMessage');
            };
            const element = document.getElementById('messages');
            element.innerHTML = Core.getText(data.errorMessage);
            element.classList.add('errorMessage');
            setTimeout(hideMessage, 3000);
        });
        Core.subscribeTo('core:showMessage', data => {
            console.log(`header.html::initHeader::showMessage::data: `, data);
            const hideMessage = () => {
                element.classList.remove('message');
            };
            const element = document.getElementById('messages');
            element.innerHTML = Core.getText(data.message);
            element.classList.add('message');
            setTimeout(hideMessage, 8000);
        });
    }

    window.addEventListener('load', initHeader);
</script>

<body>
    <div id="headerContainer">
        <div class="burguerMenuContainer" id="headerMenuContainer">
            <div class="menuItems">
                <div class="menuItem" id="users">
                    <texts>
                        <text language="es">usuarios</text>
                        <text language="en">users</text>
                    </texts>
                </div>
                <div class="menuItem" id="places">
                    <texts>
                        <text language="es">lugares</text>
                        <text language="en">places</text>
                    </texts>
                </div>
                <div class="menuItem" id="login">
                    <texts>
                        <text language="es">acceder</text>
                        <text language="en">login</text>
                    </texts>
                </div>
                <div class="menuItem" id="logout">
                    <texts>
                        <text language="es">salir</text>
                        <text language="en">logout</text>
                    </texts>
                </div>
                <div class="menuItem" id="twoLanguageFlag"></div>
            </div>
        </div>
        <div class="logoBackground"></div>
        <div id="headerLogoContainer">
            <div id="headerLogo"></div>
            <div class="headerIcon headerBurgerMenuActivator" id="headerBurgerMenuActivator"></div>
        </div>
    </div>
</body>